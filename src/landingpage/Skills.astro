---
import HeaderSection from "../layouts/HeaderSection.astro";
import { skills } from "../data/util";
---

<section id="skills" class="my-8 align-middle max-w-6xl mx-auto px-5">
  <HeaderSection title="Skills" />
  <div class="overflow-hidden flex justify-center">
    <div
      class="flex flex-wrap justify-center sm:flex-nowrap sm:justify-start sm:w-max gap-4 p-4"
    >
      {
        skills.map((skill, index) => (
          <div
            class="skill-item w-36 h-32 bg-palette1 rounded-lg p-4 flex flex-col items-center justify-center text-white opacity-0 translate-y-10 transition-all duration-500 ease-out"
            style={`transition-delay: ${index * 100}ms`}
          >
            <span class="text-3xl mb-2">{skill.icon}</span>
            <span class="text-center text-sm font-medium">{skill.name}</span>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  function animateSkills(): void {
    const skillItems = document.querySelectorAll<HTMLElement>(".skill-item");

    const observer = new IntersectionObserver(
      (entries: IntersectionObserverEntry[]) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            (entry.target as HTMLElement).classList.add(
              "opacity-100",
              "translate-y-0",
            );
            (entry.target as HTMLElement).classList.remove(
              "opacity-0",
              "translate-y-10",
            );
          } else {
            (entry.target as HTMLElement).classList.remove(
              "opacity-100",
              "translate-y-0",
            );
            (entry.target as HTMLElement).classList.add(
              "opacity-0",
              "translate-y-10",
            );
          }
        });
      },
      { threshold: 0.1 },
    );

    skillItems.forEach((item) => observer.observe(item));
  }

  document.addEventListener("DOMContentLoaded", animateSkills);
</script>
